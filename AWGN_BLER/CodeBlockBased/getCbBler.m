function theBler = getCbBler(SNRdB, effCr, kDot, theQm, bgn)
%#codegen

x = log2(double(theQm) * effCr);
y = log2(kDot);

p00 = 100;
p10 = 0.0;
p01 = 0.0;
p20 = 0.0;
p11 = 0.0;
p02 = 0.0;
p30 = 0.0;
p21 = 0.0;
p12 = 0.0;
p03 = 0.0;

switch theQm
    case 2
        if bgn==1
            p00 =      -32.44;
            p10 =       1.092;
            p01 =       7.829;
            p20 =      0.7227;
            p11 =      0.5441;
            p02 =     -0.6039;
            p30 =     0.04443;
            p21 =    0.008843;
            p12 =     -0.0222;
            p03 =     0.01558;
        else
            p00 =       2.034;
            p10 =       4.632;
            p01 =      -0.275;
            p20 =      0.4894;
            p11 =    -0.06869;
            p02 =     0.03335;
            p30 =     0.05733;
            p21 =   -0.001592;
            p12 =    0.002836;
            p03 =   -0.001098;
        end
    case 4
        if bgn==1
            p00 =      -30.33;
            p10 =       10.76;
            p01 =       6.832;
            p20 =      0.1836;
            p11 =      -1.084;
            p02 =     -0.4745;
            p30 =      0.4429;
            p21 =    -0.01172;
            p12 =     0.04419;
            p03 =     0.01083;
        else
            p00 =      -1.417;
            p10 =        2.37;
            p01 =       1.055;
            p20 =      0.8243;
            p11 =      0.1713;
            p02 =     -0.1051;
            p30 =    -0.05655;
            p21 =     0.07703;
            p12 =    -0.01474;
            p03 =    0.003864;
        end
    case 6
        if bgn==1
            p00 =       14.02;
            p10 =       24.52;
            p01 =      -5.858;
            p20 =      -13.93;
            p11 =      0.5707;
            p02 =      0.4616;
            p30 =       2.914;
            p21 =     0.05406;
            p12 =    -0.03176;
            p03 =    -0.01152;
        else
            p00 =       5.475;
            p10 =       24.78;
            p01 =      -3.755;
            p20 =      -10.95;
            p11 =     -0.6974;
            p02 =       0.401;
            p30 =       2.641;
            p21 =     0.02627;
            p12 =     0.02831;
            p03 =    -0.01353;
        end
    case 8
        if bgn==1
            p00 =        -213;
            p10 =       289.4;
            p01 =      -5.589;
            p20 =      -133.2;
            p11 =       8.948;
            p02 =     -0.5497;
            p30 =       20.27;
            p21 =      -1.663;
            p12 =    0.001697;
            p03 =     0.01553;
        else
            p00 =        -213;
            p10 =       289.4;
            p01 =      -5.589;
            p20 =      -133.2;
            p11 =       8.948;
            p02 =     -0.5497;
            p30 =       20.27;
            p21 =      -1.663;
            p12 =    0.001697;
            p03 =     0.01553;
        end
end

theMu = p00 + p10*x + p01*y + p20*x^2 + p11*x*y + p02*y^2 + p30*x^3 + p21*x^2*y + p12*x*y^2 + p03*y^3;


if bgn == 1
    p00 =       4.741;
    p10 =       1.145;
    p01 =      -1.161;
    p20 =      0.1291;
    p11 =      -0.188;
    p02 =      0.1018;
    p30 =   0.0006615;
    p21 =   -0.009932;
    p12 =    0.007849;
    p03 =   -0.003046;
else
    p00 =       7.087;
    p10 =      0.1718;
    p01 =      -1.587;
    p20 =     0.02844;
    p11 =    -0.02054;
    p02 =      0.1273;
    p30 =    0.001605;
    p21 =    -0.00158;
    p12 =   0.0006511;
    p03 =   -0.003559;
end

theSigma = p00 + p10*x + p01*y + p20*x^2 + p11*x*y + p02*y^2 + p30*x^3 + p21*x^2*y + p12*x*y^2 + p03*y^3;

theBler = erfc((SNRdB - theMu) / theSigma) / 2.0;
end
